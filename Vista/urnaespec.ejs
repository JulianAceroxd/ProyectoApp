
        <!DOCTYPE html>
        <html lang="es">
        <head>
            <meta charset="UTF-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
            <link rel="icon" href="img/logo.jpg">
            <link rel="stylesheet" href="/css/urnas.css">
            <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Lobster&family=Merriweather:wght@700&family=Poppins:wght@300;400;500&display=swap" rel="stylesheet">
            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
            <script src="https://kit.fontawesome.com/a076d05399.js"></script>

            <script src="/js/jquery-3.6.0.min.js"></script>
            <script src="/js/estadisticaurna.js"></script>
          
            
            <title>Espectador</title>
        </head>
        <body>
            
            <script>
          
            </script>
            <header>
                <a href="#" class="logo">
                    <img src="/img/logo.jpg" alt="logo">
                </a>
                <div id="header">
                    <ul class="nav">
                       
                <li><a href="/" class="">Inicio</a></li> 
                <li><a href="/urnaespec" class="">Urna</a></li>
                <li>  <a href="/foros" class="">Foros de discusion</a></li>
                <li>  <a href="/NotiEspec" class="">Noticias</a></li>
                <li><a href="">Partidos</a>
                    <ul id="partidos">

                    </ul>
                </li>
                <li> <a href="/login" class="">Login</a></li>
                <li>  <a href="/Registro" class="">Registrate</a></li>
                    <nav>
                      
                        <!--<a href="/crearparti" class="">crearpartido</a>
                        <a href="/crearforo" class="">crearforo</a>
                        <a href="/crearurna" class="">crearurna</a>
                        <a href="/admin" class="">Administrador</a>-->
                        
                    </nav>
            </header>
            <script>
                let =url='/partidos'
                fetch(url)
                .then(Response=>Response.json())
                .then(data=>mostrarDatos(data))
                .catch(error=>console.log(error))
                const mostrarDatos=(data)=>{
                console.log(data)
                let body=''
                for(i=0; i<data.length;i++){
                    body+=`
                        
                                <li><a href="/partidoespec/${data[i].IdPartido}">${data[i].NomPartido}</a></li>
                            
                                    `
                               
        
                }
                document.getElementById('partidos').innerHTML=body
                 console.log(body)
            }
            </script>
            <div class="contitu">
        <H1 class="titu"><a>Modulo Urnas</a></H1>
        </div>
        <div>
            <div id="alert" class="alert show">
                <span class="fas fa-exclamation-circle"></span>
                <span class="msg">Nota:Si Deseas Participar En Alguna Urna Inicia Sesion O Registrate</span>
                <span class="close-btn">
                    <span class="fas fa-times"></span>
                </span>
              </div>
       
            <% Datos.forEach(function (Datos){ %>
           

                   
                <div class="contnomde">
                <h1 class="bot"><%=Datos.NomUrna%></h1>
                <p class="bot"><%=Datos.DesUrna%></p>
                <input class="botons" type="button" value="Ver Urna" class="Confirmar">
            </div>
        
                <input type="hidden" class="id" value="<%=Datos.IdUrna%>" id="valor">
                
           
                <div  class="botones3" id="botones<%=Datos.IdUrna%>">
         
                </div>
            <canvas class="estadisticafondo" id="myChart<%=Datos.IdUrna%>" ></canvas>
         
             
             <%})%>
            <script>
                
                 $(document).ready(function(){
                    $('.close-btn').on('click',function(){
     
        $('.alert').addClass("hide");
      $('.alert').removeClass("show");
      });

      $('.botons').on('click',function(){
     
        $('.alert').addClass("showAlert");
      $('.alert').addClass("show");
      $('.alert').addClass("showAlert");
   })

         
         $('.botons').on('click',function(){
        
        let btn=$('.botons').index(this);
        let doc=$('.id').eq(btn);
        
        let d=doc.val();
     
   
        const d2={
            id: d
        };
        
                let ctx=document.getElementById('myChart'+d)
                 var myChart=new Chart(ctx,{
                     type:'bar',
                     data:{
                         datasets:[{
                             
                             label:'Estadisticas Urna', 
                             backgroundColor:['yellow','#87CEFA','red','violet','blue'],
                             borderColor:['#3F2212'],
                             borderwidth:3
                             
                      } ]
                     },
                     options:{
                         scales:{
                             y:{
                                 width: 10,
                                beginAtZeto:true,
                                maintainAspectRatio: false
                             }
                         }
                     }
        
                 })
                
                 let url='/urnadatos'
                 fetch(url,{
            method:'POST',
            headers:{
                
        
                "content-Type":"application/json",
            },
            body: JSON.stringify(d2),
           })
                 .then(response=>response.json())
                 .then(data=>mostrar(data))
                 .catch(error=>console.log(error))
        
                 const mostrar=(data)=>{
                    console.log (data.length)
                     data.forEach(element => {
                         myChart.data['labels'].push(element.Opcion)
                         myChart.data['datasets'][0].data.push(element.cantidad)
                         myChart.update();
                    
                     });
                  
              
                     
                 }
                });
        });
                
            </script>
         
        </body>
        </html>